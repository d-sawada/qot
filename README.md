# README

## 勤怠管理アプリクローン　Queen of Time

どこかで聞いたことがあるような響きのする名前の習作アプリです
テーブル操作の練習になると思いこの題材にしました

## 操作

### 設定画面

実際に作業する際は利用頻度が低いと思われる操作をタブを使って画面を移動せずに操作できる画面
社員と勤務予定を紐付けるための操作として
パターン作成 → テンプレート作成 → 雇用区分作成 → 社員作成の順にデータを登録していく流れとなっている

#### パターン画面

- 一日の出退勤時間と休憩時間のパターンに名前をつけて保存する
- パターンの作成・編集・削除を行える

#### テンプレート画面

- パターンが１つ以上存在しないと操作ができない
- 作成したパターンを曜日ごとに当てはめてテンプレート名をつけて保存する
- テンプレートの作成・編集・削除を行える

#### 雇用区分画面

- テンプレートが１つ以上存在しないと操作ができない
- 作成したテンプレートを雇用区分に割り当てることで、この雇用区分を持つ社員が打刻を登録した際に対応する曜日のパターンを自動的に適用する
- 雇用区分の作成・編集・削除を行える

#### 社員追加情報画面

- 社員の情報を追加できる（部署など）
- 追加すると社員の新規作成と編集画面に追加のフォームが出現し変更できるようになる

#### 管理者

- 総合管理者のみこのタブを操作可能
- 企業管理者を作成・編集・削除できる
- ログイン中の管理者自身のパスワードを変更した場合は再ログインを促す仕様にしている
- 更新時に現在パスワードを必須としない仕様にしている

#### その他

- 会社単位のその他雑多な設定はここに置く
- 現在は申請を処理した際にメールを送信するかどうかのみ設定できる
- ラジオボタンを変更すると即座にデータベースに反映される

### 新規社員社員作成画面

- 管理者画面において設定ページの左の、人型に＋のついたアイコンのページ
- 雇用区分が１つ以上存在しないと操作ができない

### データ画面

社員の打刻に関する情報を社員全体・個別 x 日毎・月毎の４パターンで確認できる
CSV出力ボタンを押すことでデータを取得することができる

#### 日別一覧画面

- 管理者画面においてヘッダメニューの一番左のページ
- 日毎の社員全員の勤務パターン、出退勤打刻などを確認するページ
- 日切り替えボタンで前後の日付に移動したり、当日の日付に移動したりすることができる
- `詳細`リンクから日別個別画面へ移動できる
- `パターン一括変更`ボタンからパターンを選択することで、選択した社員の当該日のパターンを一括で変更できる。この変更によるパターンの設定はテンプレートによる自動設定を上書きする
- `打刻一括修正`ボタンにより選択した社員の打刻を一括で修正することができる。履歴として申請が残るが、自動で承認されすぐに変更される

#### 日別個別画面

- 日別一覧画面から遷移できるページ
- 日別一覧画面における当該社員のテーブル行だけ持ってきたようなページである
- `打刻修正を登録`リンクから当該日付・当該社員に対する打刻修正を登録できる
- 社員の削除と社員の情報編集はこのページと月別個別画面で行える

#### 月別一覧画面

- 管理者画面に置いてヘッダメニューの左から２番目のページ
- 社員全員の月別の勤怠集計を一覧で確認するページ
- 集計項目は
  - 勤務日数 ... 月全体で登録されたパターンの数
  - 所定時間 ... 月全体で登録された所定労働時間（終了-開始)。ただし6時間以上なら45分、8時間以上なら60分自動で引かれる。休憩時間の設定は関係ない
  - 出勤日数 ... 出勤打刻と退勤打刻が両方存在する日数
  - 所定内 ... 出勤打刻から退勤打刻までの時間内かつ所定時間に入っている時間。所定時間同様休憩時間が自動で引かれる
  - 休出日数 ... 出勤日数のうちパターンが設定されていない日付の日数
  - 休出時間 ... パターンが設定されていない日の勤務時間。所定勤務時間が設定されていないので（退勤打刻-出勤打刻）となる
- `詳細`リンクから月別個別画面へ移動できる

#### 月別個別画面

- 月別一覧画面から遷移できるページ
- 月別一覧画面における当該社員の集計部分＋該当月の各日付の出勤パターンと出退勤打刻を確認するページ
- 各日付に対する`打刻修正を登録`リンクから修正を登録できる
- 各日付に対する'詳細'リンクから日別個別画面に移動できる

### 打刻修正申請関連

#### 申請一覧画面

- 管理者が登録した申請と社員が登録した申請を一覧で確認できる
- `詳細`リンクから申請詳細ページへ移動できる

#### 申請詳細画面

- 申請の状態の他、社員のコメント・管理者のコメントを確認できる
- 承認/棄却を選択して申請を処理できる。メールを送る設定になっていればこの時当該社員のメールアドレス宛にメールが送られる

### その他の挙動

- 現在テーブルに付いているSearch窓は全カラム対象の絞り込み検索
- アプリロゴは/topへのリンクになっている。ログイン済みなら自動的にユーザ種別に応じたページへ遷移する（日別一覧画面/タイムカード画面)
- ログアウト後は企業別のユーザ種別に応じたページへ遷移する

